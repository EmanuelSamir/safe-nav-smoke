# @package _global_
# Configuration for FM NP (Autonmous Flow Matching Neural Process)
training:
  experiment_name: "fm_np_experiment"
  output_dir: "outputs/training/fm_np"
  seed: 42
  
  data:
    data_path: "data/playback_data/global_source_400_100_2nd.npz"
    batch_size: 4
    train_split: 0.9
    max_samples: null
    context_frames: 10
    target_frames: 15
    info_ratio_per_frame: 0.2
    num_workers: 0

  model:
    type: "fmnp"
    dim_x: 3 # (x, y, t)
    dim_y: 1 # smoke
    dim_posenc: 10
    d_model: 128
    emb_depth: 2
    dim_feedforward: 256
    nhead: 4
    dropout: 0.0
    num_layers: 4
    sampling_steps: 20

  optimizer:
    lr: 1e-4
    max_epochs: 500
    grad_clip: 1.0

  loss:
    mse_weight: 1.0 # Not used directly, FM loss is MSE on velocity

  checkpoint:
    save_top_k: 3
    monitor: "val_loss"
    mode: "min"
